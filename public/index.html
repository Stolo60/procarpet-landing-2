<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ProCarpet — Nettoyage de tapis</title>
  <meta name="description" content="ProCarpet — Nettoyage de tapis écologique à partir de 40 $.">
  <link rel="icon" href="/static/favicon.ico">
  <style>
    :root{--bg:#F8FAFC;--text:#0B1220;--accent:#22C55E;--ring:rgba(34,197,94,.35);--muted:#5B6471}
    *{box-sizing:border-box}body{margin:0;font-family:system-ui,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--text)}
    .container{max-width:1120px;margin:0 auto;padding:0 20px}
    header{border-bottom:1px solid #edf0f3;background:rgba(248,250,252,.8);backdrop-filter:saturate(180%) blur(10px)}
    .head{display:flex;justify-content:space-between;align-items:center;padding:12px 0}
    .brand{display:flex;gap:10px;align-items:center;font-weight:800}
    .badge{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#34d399);display:grid;place-items:center;color:#fff}
    .hero{padding:46px 0 28px}
    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:24px;align-items:center}
    .btn{padding:12px 16px;border-radius:14px;border:1px solid #e5e7eb;text-decoration:none;font-weight:700;display:inline-block}
    .btn-primary{background:var(--accent);border-color:transparent;color:#fff}
    .media{border-radius:20px;overflow:hidden;border:1px solid #e9eef2}
    .media img{width:100%;display:block}
    form{display:grid;gap:10px;margin-top:12px}
    input,textarea{padding:12px 14px;border:1px solid #d8dee6;border-radius:12px}
    input:focus,textarea:focus{border-color:var(--accent);box-shadow:0 0 0 4px var(--ring);outline:none}
    footer{border-top:1px solid #edf0f3;padding:18px 0 36px;color:var(--muted);margin-top:40px}
    @media(max-width:960px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="container head">
      <div class="brand"><div class="badge">P</div><div>ProCarpet</div></div>
      <div style="display:flex;gap:8px">
        <button id="btn-fr" class="btn">FR</button>
        <button id="btn-en" class="btn">EN</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="grid">
        <div>
          <h1 data-i18n="hero_title">Nettoyage de tapis professionnel</h1>
          <p data-i18n="hero_sub">À partir de 40 $ — service rapide et respectueux de l’environnement.</p>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <a href="#devis" class="btn btn-primary" data-i18n="cta_quote">Demander un devis</a>
            <a href="tel:15145157902" class="btn" data-i18n="cta_call">Appeler (514-515-7902)</a>
          </div>
        </div>
        <div class="media">
          <img src="/static/carpet-2935773_640.jpg" alt="Carpet cleaning">
        </div>
      </div>
    </section>

    <section id="devis">
      <h2 data-i18n="form_title">Envoyez-nous un message</h2>
      <form id="contactForm">
        <input id="name" placeholder="Nom">
        <input id="phone" placeholder="Téléphone">
        <textarea id="message" placeholder="Votre message"></textarea>
        <input type="hidden" id="lang" value="fr">
        <button id="sendBtn" class="btn btn-primary" type="submit" data-i18n="send">Envoyer</button>
      </form>
    </section>
  </main>

  <footer><div class="container">© <span id="year"></span> ProCarpet</div></footer>

  <script>
    const I18N={fr:{hero_title:"Nettoyage de tapis professionnel",hero_sub:"À partir de 40 $ — service rapide et respectueux de l’environnement.",cta_quote:"Demander un devis",cta_call:"Appeler (514-515-7902)",form_title:"Envoyez-nous un message",send:"Envoyer"},en:{hero_title:"Professional carpet cleaning",hero_sub:"Starting at $40 — fast and eco-conscious.",cta_quote:"Request a quote",cta_call:"Call (514-515-7902)",form_title:"Send us a message",send:"Send"}};
    const $=s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
    const setLang=lang=>{document.documentElement.lang=lang;localStorage.setItem('pc_lang',lang);$("#lang").value=lang;$$('[data-i18n]').forEach(el=>{const k=el.getAttribute('data-i18n');el.textContent=I18N[lang][k]||el.textContent;});};
    $("#btn-fr").onclick=()=>setLang('fr'); $("#btn-en").onclick=()=>setLang('en'); setLang(localStorage.getItem('pc_lang')||'fr');
    $("#year").textContent=new Date().getFullYear();
    $("#contactForm").addEventListener("submit",async e=>{
      e.preventDefault();
      const btn=$("#sendBtn"); btn.disabled=true;
      btn.textContent=document.documentElement.lang==='fr'?'Envoi...':'Sending...';
      const payload={name:$("#name").value,phone:$("#phone").value,message:$("#message").value,lang:$("#lang").value};
      try{
        const res=await fetch("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});
        if(!res.ok) throw new Error("send");
        alert(document.documentElement.lang==='fr'?'Message envoyé ✔':'Message sent ✔');
        $("#name").value=""; $("#phone").value=""; $("#message").value="";
      }catch(err){
        alert(document.documentElement.lang==='fr'?'Envoi impossible.':'Send failed.');
      }finally{
        btn.disabled=false;
        btn.textContent=document.documentElement.lang==='fr'?'Envoyer':'Send';
      }
    });
  </script>
</body>
</html>
